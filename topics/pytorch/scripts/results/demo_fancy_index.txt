
----------------------------------- (1) NHW -----------------------------------

INPUT:
90
torch.Size([2, 9, 5])
tensor([[[ 1.,  2.,  3.,  4.,  5.],
         [ 6.,  7.,  8.,  9., 10.],
         [11., 12., 13., 14., 15.],
         [16., 17., 18., 19., 20.],
         [21., 22., 23., 24., 25.],
         [26., 27., 28., 29., 30.],
         [31., 32., 33., 34., 35.],
         [36., 37., 38., 39., 40.],
         [41., 42., 43., 44., 45.]],

        [[46., 47., 48., 49., 50.],
         [51., 52., 53., 54., 55.],
         [56., 57., 58., 59., 60.],
         [61., 62., 63., 64., 65.],
         [66., 67., 68., 69., 70.],
         [71., 72., 73., 74., 75.],
         [76., 77., 78., 79., 80.],
         [81., 82., 83., 84., 85.],
         [86., 87., 88., 89., 90.]]])
-------------------------------------------------------------------------------
IDENTITY:
90
torch.Size([2, 9, 5])
tensor([[[ 1.,  2.,  3.,  4.,  5.],
         [ 6.,  7.,  8.,  9., 10.],
         [11., 12., 13., 14., 15.],
         [16., 17., 18., 19., 20.],
         [21., 22., 23., 24., 25.],
         [26., 27., 28., 29., 30.],
         [31., 32., 33., 34., 35.],
         [36., 37., 38., 39., 40.],
         [41., 42., 43., 44., 45.]],

        [[46., 47., 48., 49., 50.],
         [51., 52., 53., 54., 55.],
         [56., 57., 58., 59., 60.],
         [61., 62., 63., 64., 65.],
         [66., 67., 68., 69., 70.],
         [71., 72., 73., 74., 75.],
         [76., 77., 78., 79., 80.],
         [81., 82., 83., 84., 85.],
         [86., 87., 88., 89., 90.]]])
-------------------------------------------------------------------------------
TRANSPOSE:
90
torch.Size([2, 5, 9])
tensor([[[ 1.,  6., 11., 16., 21., 26., 31., 36., 41.],
         [ 2.,  7., 12., 17., 22., 27., 32., 37., 42.],
         [ 3.,  8., 13., 18., 23., 28., 33., 38., 43.],
         [ 4.,  9., 14., 19., 24., 29., 34., 39., 44.],
         [ 5., 10., 15., 20., 25., 30., 35., 40., 45.]],

        [[46., 51., 56., 61., 66., 71., 76., 81., 86.],
         [47., 52., 57., 62., 67., 72., 77., 82., 87.],
         [48., 53., 58., 63., 68., 73., 78., 83., 88.],
         [49., 54., 59., 64., 69., 74., 79., 84., 89.],
         [50., 55., 60., 65., 70., 75., 80., 85., 90.]]])
-------------------------------------------------------------------------------
UNFLATTEN:
90
torch.Size([2, 3, 3, 5])
tensor([[[[ 1.,  2.,  3.,  4.,  5.],
          [ 6.,  7.,  8.,  9., 10.],
          [11., 12., 13., 14., 15.]],

         [[16., 17., 18., 19., 20.],
          [21., 22., 23., 24., 25.],
          [26., 27., 28., 29., 30.]],

         [[31., 32., 33., 34., 35.],
          [36., 37., 38., 39., 40.],
          [41., 42., 43., 44., 45.]]],


        [[[46., 47., 48., 49., 50.],
          [51., 52., 53., 54., 55.],
          [56., 57., 58., 59., 60.]],

         [[61., 62., 63., 64., 65.],
          [66., 67., 68., 69., 70.],
          [71., 72., 73., 74., 75.]],

         [[76., 77., 78., 79., 80.],
          [81., 82., 83., 84., 85.],
          [86., 87., 88., 89., 90.]]]])
-------------------------------------------------------------------------------
UNFLATTEN + TRANSPOSE:
90
torch.Size([2, 3, 5, 3])
tensor([[[[ 1.,  6., 11.],
          [ 2.,  7., 12.],
          [ 3.,  8., 13.],
          [ 4.,  9., 14.],
          [ 5., 10., 15.]],

         [[16., 21., 26.],
          [17., 22., 27.],
          [18., 23., 28.],
          [19., 24., 29.],
          [20., 25., 30.]],

         [[31., 36., 41.],
          [32., 37., 42.],
          [33., 38., 43.],
          [34., 39., 44.],
          [35., 40., 45.]]],


        [[[46., 51., 56.],
          [47., 52., 57.],
          [48., 53., 58.],
          [49., 54., 59.],
          [50., 55., 60.]],

         [[61., 66., 71.],
          [62., 67., 72.],
          [63., 68., 73.],
          [64., 69., 74.],
          [65., 70., 75.]],

         [[76., 81., 86.],
          [77., 82., 87.],
          [78., 83., 88.],
          [79., 84., 89.],
          [80., 85., 90.]]]])
-------------------------------------------------------------------------------
INPUT:
90
torch.Size([2, 9, 5])
tensor([[[ 1.,  2.,  3.,  4.,  5.],
         [ 6.,  7.,  8.,  9., 10.],
         [11., 12., 13., 14., 15.],
         [16., 17., 18., 19., 20.],
         [21., 22., 23., 24., 25.],
         [26., 27., 28., 29., 30.],
         [31., 32., 33., 34., 35.],
         [36., 37., 38., 39., 40.],
         [41., 42., 43., 44., 45.]],

        [[46., 47., 48., 49., 50.],
         [51., 52., 53., 54., 55.],
         [56., 57., 58., 59., 60.],
         [61., 62., 63., 64., 65.],
         [66., 67., 68., 69., 70.],
         [71., 72., 73., 74., 75.],
         [76., 77., 78., 79., 80.],
         [81., 82., 83., 84., 85.],
         [86., 87., 88., 89., 90.]]])
-------------------------------------------------------------------------------
UNFLATTEN + FLATTEN:
90
torch.Size([2, 3, 15])
tensor([[[ 1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12., 13., 14., 15.],
         [16., 17., 18., 19., 20., 21., 22., 23., 24., 25., 26., 27., 28., 29., 30.],
         [31., 32., 33., 34., 35., 36., 37., 38., 39., 40., 41., 42., 43., 44., 45.]],

        [[46., 47., 48., 49., 50., 51., 52., 53., 54., 55., 56., 57., 58., 59., 60.],
         [61., 62., 63., 64., 65., 66., 67., 68., 69., 70., 71., 72., 73., 74., 75.],
         [76., 77., 78., 79., 80., 81., 82., 83., 84., 85., 86., 87., 88., 89., 90.]]])
-------------------------------------------------------------------------------
UNFOLD:
810
torch.Size([2, 9, 5, 9])
tensor([[[[45., 41., 42.,  5.,  1.,  2., 10.,  6.,  7.],
          [41., 42., 43.,  1.,  2.,  3.,  6.,  7.,  8.],
          [42., 43., 44.,  2.,  3.,  4.,  7.,  8.,  9.],
          [43., 44., 45.,  3.,  4.,  5.,  8.,  9., 10.],
          [44., 45., 41.,  4.,  5.,  1.,  9., 10.,  6.]],

         [[ 5.,  1.,  2., 10.,  6.,  7., 15., 11., 12.],
          [ 1.,  2.,  3.,  6.,  7.,  8., 11., 12., 13.],
          [ 2.,  3.,  4.,  7.,  8.,  9., 12., 13., 14.],
          [ 3.,  4.,  5.,  8.,  9., 10., 13., 14., 15.],
          [ 4.,  5.,  1.,  9., 10.,  6., 14., 15., 11.]],

         [[10.,  6.,  7., 15., 11., 12., 20., 16., 17.],
          [ 6.,  7.,  8., 11., 12., 13., 16., 17., 18.],
          [ 7.,  8.,  9., 12., 13., 14., 17., 18., 19.],
          [ 8.,  9., 10., 13., 14., 15., 18., 19., 20.],
          [ 9., 10.,  6., 14., 15., 11., 19., 20., 16.]],

         [[15., 11., 12., 20., 16., 17., 25., 21., 22.],
          [11., 12., 13., 16., 17., 18., 21., 22., 23.],
          [12., 13., 14., 17., 18., 19., 22., 23., 24.],
          [13., 14., 15., 18., 19., 20., 23., 24., 25.],
          [14., 15., 11., 19., 20., 16., 24., 25., 21.]],

         [[20., 16., 17., 25., 21., 22., 30., 26., 27.],
          [16., 17., 18., 21., 22., 23., 26., 27., 28.],
          [17., 18., 19., 22., 23., 24., 27., 28., 29.],
          [18., 19., 20., 23., 24., 25., 28., 29., 30.],
          [19., 20., 16., 24., 25., 21., 29., 30., 26.]],

         [[25., 21., 22., 30., 26., 27., 35., 31., 32.],
          [21., 22., 23., 26., 27., 28., 31., 32., 33.],
          [22., 23., 24., 27., 28., 29., 32., 33., 34.],
          [23., 24., 25., 28., 29., 30., 33., 34., 35.],
          [24., 25., 21., 29., 30., 26., 34., 35., 31.]],

         [[30., 26., 27., 35., 31., 32., 40., 36., 37.],
          [26., 27., 28., 31., 32., 33., 36., 37., 38.],
          [27., 28., 29., 32., 33., 34., 37., 38., 39.],
          [28., 29., 30., 33., 34., 35., 38., 39., 40.],
          [29., 30., 26., 34., 35., 31., 39., 40., 36.]],

         [[35., 31., 32., 40., 36., 37., 45., 41., 42.],
          [31., 32., 33., 36., 37., 38., 41., 42., 43.],
          [32., 33., 34., 37., 38., 39., 42., 43., 44.],
          [33., 34., 35., 38., 39., 40., 43., 44., 45.],
          [34., 35., 31., 39., 40., 36., 44., 45., 41.]],

         [[40., 36., 37., 45., 41., 42.,  5.,  1.,  2.],
          [36., 37., 38., 41., 42., 43.,  1.,  2.,  3.],
          [37., 38., 39., 42., 43., 44.,  2.,  3.,  4.],
          [38., 39., 40., 43., 44., 45.,  3.,  4.,  5.],
          [39., 40., 36., 44., 45., 41.,  4.,  5.,  1.]]],


        [[[90., 86., 87., 50., 46., 47., 55., 51., 52.],
          [86., 87., 88., 46., 47., 48., 51., 52., 53.],
          [87., 88., 89., 47., 48., 49., 52., 53., 54.],
          [88., 89., 90., 48., 49., 50., 53., 54., 55.],
          [89., 90., 86., 49., 50., 46., 54., 55., 51.]],

         [[50., 46., 47., 55., 51., 52., 60., 56., 57.],
          [46., 47., 48., 51., 52., 53., 56., 57., 58.],
          [47., 48., 49., 52., 53., 54., 57., 58., 59.],
          [48., 49., 50., 53., 54., 55., 58., 59., 60.],
          [49., 50., 46., 54., 55., 51., 59., 60., 56.]],

         [[55., 51., 52., 60., 56., 57., 65., 61., 62.],
          [51., 52., 53., 56., 57., 58., 61., 62., 63.],
          [52., 53., 54., 57., 58., 59., 62., 63., 64.],
          [53., 54., 55., 58., 59., 60., 63., 64., 65.],
          [54., 55., 51., 59., 60., 56., 64., 65., 61.]],

         [[60., 56., 57., 65., 61., 62., 70., 66., 67.],
          [56., 57., 58., 61., 62., 63., 66., 67., 68.],
          [57., 58., 59., 62., 63., 64., 67., 68., 69.],
          [58., 59., 60., 63., 64., 65., 68., 69., 70.],
          [59., 60., 56., 64., 65., 61., 69., 70., 66.]],

         [[65., 61., 62., 70., 66., 67., 75., 71., 72.],
          [61., 62., 63., 66., 67., 68., 71., 72., 73.],
          [62., 63., 64., 67., 68., 69., 72., 73., 74.],
          [63., 64., 65., 68., 69., 70., 73., 74., 75.],
          [64., 65., 61., 69., 70., 66., 74., 75., 71.]],

         [[70., 66., 67., 75., 71., 72., 80., 76., 77.],
          [66., 67., 68., 71., 72., 73., 76., 77., 78.],
          [67., 68., 69., 72., 73., 74., 77., 78., 79.],
          [68., 69., 70., 73., 74., 75., 78., 79., 80.],
          [69., 70., 66., 74., 75., 71., 79., 80., 76.]],

         [[75., 71., 72., 80., 76., 77., 85., 81., 82.],
          [71., 72., 73., 76., 77., 78., 81., 82., 83.],
          [72., 73., 74., 77., 78., 79., 82., 83., 84.],
          [73., 74., 75., 78., 79., 80., 83., 84., 85.],
          [74., 75., 71., 79., 80., 76., 84., 85., 81.]],

         [[80., 76., 77., 85., 81., 82., 90., 86., 87.],
          [76., 77., 78., 81., 82., 83., 86., 87., 88.],
          [77., 78., 79., 82., 83., 84., 87., 88., 89.],
          [78., 79., 80., 83., 84., 85., 88., 89., 90.],
          [79., 80., 76., 84., 85., 81., 89., 90., 86.]],

         [[85., 81., 82., 90., 86., 87., 50., 46., 47.],
          [81., 82., 83., 86., 87., 88., 46., 47., 48.],
          [82., 83., 84., 87., 88., 89., 47., 48., 49.],
          [83., 84., 85., 88., 89., 90., 48., 49., 50.],
          [84., 85., 81., 89., 90., 86., 49., 50., 46.]]]])
-------------------------------------------------------------------------------
UNFOLD + FLATTEN:
810
torch.Size([2, 45, 9])
tensor([[[45., 41., 42.,  5.,  1.,  2., 10.,  6.,  7.],
         [41., 42., 43.,  1.,  2.,  3.,  6.,  7.,  8.],
         [42., 43., 44.,  2.,  3.,  4.,  7.,  8.,  9.],
         [43., 44., 45.,  3.,  4.,  5.,  8.,  9., 10.],
         [44., 45., 41.,  4.,  5.,  1.,  9., 10.,  6.],
         [ 5.,  1.,  2., 10.,  6.,  7., 15., 11., 12.],
         [ 1.,  2.,  3.,  6.,  7.,  8., 11., 12., 13.],
         [ 2.,  3.,  4.,  7.,  8.,  9., 12., 13., 14.],
         [ 3.,  4.,  5.,  8.,  9., 10., 13., 14., 15.],
         [ 4.,  5.,  1.,  9., 10.,  6., 14., 15., 11.],
         [10.,  6.,  7., 15., 11., 12., 20., 16., 17.],
         [ 6.,  7.,  8., 11., 12., 13., 16., 17., 18.],
         [ 7.,  8.,  9., 12., 13., 14., 17., 18., 19.],
         [ 8.,  9., 10., 13., 14., 15., 18., 19., 20.],
         [ 9., 10.,  6., 14., 15., 11., 19., 20., 16.],
         [15., 11., 12., 20., 16., 17., 25., 21., 22.],
         [11., 12., 13., 16., 17., 18., 21., 22., 23.],
         [12., 13., 14., 17., 18., 19., 22., 23., 24.],
         [13., 14., 15., 18., 19., 20., 23., 24., 25.],
         [14., 15., 11., 19., 20., 16., 24., 25., 21.],
         [20., 16., 17., 25., 21., 22., 30., 26., 27.],
         [16., 17., 18., 21., 22., 23., 26., 27., 28.],
         [17., 18., 19., 22., 23., 24., 27., 28., 29.],
         [18., 19., 20., 23., 24., 25., 28., 29., 30.],
         [19., 20., 16., 24., 25., 21., 29., 30., 26.],
         [25., 21., 22., 30., 26., 27., 35., 31., 32.],
         [21., 22., 23., 26., 27., 28., 31., 32., 33.],
         [22., 23., 24., 27., 28., 29., 32., 33., 34.],
         [23., 24., 25., 28., 29., 30., 33., 34., 35.],
         [24., 25., 21., 29., 30., 26., 34., 35., 31.],
         [30., 26., 27., 35., 31., 32., 40., 36., 37.],
         [26., 27., 28., 31., 32., 33., 36., 37., 38.],
         [27., 28., 29., 32., 33., 34., 37., 38., 39.],
         [28., 29., 30., 33., 34., 35., 38., 39., 40.],
         [29., 30., 26., 34., 35., 31., 39., 40., 36.],
         [35., 31., 32., 40., 36., 37., 45., 41., 42.],
         [31., 32., 33., 36., 37., 38., 41., 42., 43.],
         [32., 33., 34., 37., 38., 39., 42., 43., 44.],
         [33., 34., 35., 38., 39., 40., 43., 44., 45.],
         [34., 35., 31., 39., 40., 36., 44., 45., 41.],
         [40., 36., 37., 45., 41., 42.,  5.,  1.,  2.],
         [36., 37., 38., 41., 42., 43.,  1.,  2.,  3.],
         [37., 38., 39., 42., 43., 44.,  2.,  3.,  4.],
         [38., 39., 40., 43., 44., 45.,  3.,  4.,  5.],
         [39., 40., 36., 44., 45., 41.,  4.,  5.,  1.]],

        [[90., 86., 87., 50., 46., 47., 55., 51., 52.],
         [86., 87., 88., 46., 47., 48., 51., 52., 53.],
         [87., 88., 89., 47., 48., 49., 52., 53., 54.],
         [88., 89., 90., 48., 49., 50., 53., 54., 55.],
         [89., 90., 86., 49., 50., 46., 54., 55., 51.],
         [50., 46., 47., 55., 51., 52., 60., 56., 57.],
         [46., 47., 48., 51., 52., 53., 56., 57., 58.],
         [47., 48., 49., 52., 53., 54., 57., 58., 59.],
         [48., 49., 50., 53., 54., 55., 58., 59., 60.],
         [49., 50., 46., 54., 55., 51., 59., 60., 56.],
         [55., 51., 52., 60., 56., 57., 65., 61., 62.],
         [51., 52., 53., 56., 57., 58., 61., 62., 63.],
         [52., 53., 54., 57., 58., 59., 62., 63., 64.],
         [53., 54., 55., 58., 59., 60., 63., 64., 65.],
         [54., 55., 51., 59., 60., 56., 64., 65., 61.],
         [60., 56., 57., 65., 61., 62., 70., 66., 67.],
         [56., 57., 58., 61., 62., 63., 66., 67., 68.],
         [57., 58., 59., 62., 63., 64., 67., 68., 69.],
         [58., 59., 60., 63., 64., 65., 68., 69., 70.],
         [59., 60., 56., 64., 65., 61., 69., 70., 66.],
         [65., 61., 62., 70., 66., 67., 75., 71., 72.],
         [61., 62., 63., 66., 67., 68., 71., 72., 73.],
         [62., 63., 64., 67., 68., 69., 72., 73., 74.],
         [63., 64., 65., 68., 69., 70., 73., 74., 75.],
         [64., 65., 61., 69., 70., 66., 74., 75., 71.],
         [70., 66., 67., 75., 71., 72., 80., 76., 77.],
         [66., 67., 68., 71., 72., 73., 76., 77., 78.],
         [67., 68., 69., 72., 73., 74., 77., 78., 79.],
         [68., 69., 70., 73., 74., 75., 78., 79., 80.],
         [69., 70., 66., 74., 75., 71., 79., 80., 76.],
         [75., 71., 72., 80., 76., 77., 85., 81., 82.],
         [71., 72., 73., 76., 77., 78., 81., 82., 83.],
         [72., 73., 74., 77., 78., 79., 82., 83., 84.],
         [73., 74., 75., 78., 79., 80., 83., 84., 85.],
         [74., 75., 71., 79., 80., 76., 84., 85., 81.],
         [80., 76., 77., 85., 81., 82., 90., 86., 87.],
         [76., 77., 78., 81., 82., 83., 86., 87., 88.],
         [77., 78., 79., 82., 83., 84., 87., 88., 89.],
         [78., 79., 80., 83., 84., 85., 88., 89., 90.],
         [79., 80., 76., 84., 85., 81., 89., 90., 86.],
         [85., 81., 82., 90., 86., 87., 50., 46., 47.],
         [81., 82., 83., 86., 87., 88., 46., 47., 48.],
         [82., 83., 84., 87., 88., 89., 47., 48., 49.],
         [83., 84., 85., 88., 89., 90., 48., 49., 50.],
         [84., 85., 81., 89., 90., 86., 49., 50., 46.]]])
-------------------------------------------------------------------------------

----------------------------------- (2) NCHW ----------------------------------

INPUT:
240
torch.Size([2, 8, 3, 5])
tensor([[[[  1.,   2.,   3.,   4.,   5.],
          [  6.,   7.,   8.,   9.,  10.],
          [ 11.,  12.,  13.,  14.,  15.]],

         [[ 16.,  17.,  18.,  19.,  20.],
          [ 21.,  22.,  23.,  24.,  25.],
          [ 26.,  27.,  28.,  29.,  30.]],

         [[ 31.,  32.,  33.,  34.,  35.],
          [ 36.,  37.,  38.,  39.,  40.],
          [ 41.,  42.,  43.,  44.,  45.]],

         [[ 46.,  47.,  48.,  49.,  50.],
          [ 51.,  52.,  53.,  54.,  55.],
          [ 56.,  57.,  58.,  59.,  60.]],

         [[ 61.,  62.,  63.,  64.,  65.],
          [ 66.,  67.,  68.,  69.,  70.],
          [ 71.,  72.,  73.,  74.,  75.]],

         [[ 76.,  77.,  78.,  79.,  80.],
          [ 81.,  82.,  83.,  84.,  85.],
          [ 86.,  87.,  88.,  89.,  90.]],

         [[ 91.,  92.,  93.,  94.,  95.],
          [ 96.,  97.,  98.,  99., 100.],
          [101., 102., 103., 104., 105.]],

         [[106., 107., 108., 109., 110.],
          [111., 112., 113., 114., 115.],
          [116., 117., 118., 119., 120.]]],


        [[[121., 122., 123., 124., 125.],
          [126., 127., 128., 129., 130.],
          [131., 132., 133., 134., 135.]],

         [[136., 137., 138., 139., 140.],
          [141., 142., 143., 144., 145.],
          [146., 147., 148., 149., 150.]],

         [[151., 152., 153., 154., 155.],
          [156., 157., 158., 159., 160.],
          [161., 162., 163., 164., 165.]],

         [[166., 167., 168., 169., 170.],
          [171., 172., 173., 174., 175.],
          [176., 177., 178., 179., 180.]],

         [[181., 182., 183., 184., 185.],
          [186., 187., 188., 189., 190.],
          [191., 192., 193., 194., 195.]],

         [[196., 197., 198., 199., 200.],
          [201., 202., 203., 204., 205.],
          [206., 207., 208., 209., 210.]],

         [[211., 212., 213., 214., 215.],
          [216., 217., 218., 219., 220.],
          [221., 222., 223., 224., 225.]],

         [[226., 227., 228., 229., 230.],
          [231., 232., 233., 234., 235.],
          [236., 237., 238., 239., 240.]]]])
-------------------------------------------------------------------------------
FLATTEN:
240
torch.Size([2, 8, 15])
tensor([[[  1.,   2.,   3.,   4.,   5.,   6.,   7.,   8.,   9.,  10.,  11.,  12.,  13.,  14.,  15.],
         [ 16.,  17.,  18.,  19.,  20.,  21.,  22.,  23.,  24.,  25.,  26.,  27.,  28.,  29.,  30.],
         [ 31.,  32.,  33.,  34.,  35.,  36.,  37.,  38.,  39.,  40.,  41.,  42.,  43.,  44.,  45.],
         [ 46.,  47.,  48.,  49.,  50.,  51.,  52.,  53.,  54.,  55.,  56.,  57.,  58.,  59.,  60.],
         [ 61.,  62.,  63.,  64.,  65.,  66.,  67.,  68.,  69.,  70.,  71.,  72.,  73.,  74.,  75.],
         [ 76.,  77.,  78.,  79.,  80.,  81.,  82.,  83.,  84.,  85.,  86.,  87.,  88.,  89.,  90.],
         [ 91.,  92.,  93.,  94.,  95.,  96.,  97.,  98.,  99., 100., 101., 102., 103., 104., 105.],
         [106., 107., 108., 109., 110., 111., 112., 113., 114., 115., 116., 117., 118., 119., 120.]],

        [[121., 122., 123., 124., 125., 126., 127., 128., 129., 130., 131., 132., 133., 134., 135.],
         [136., 137., 138., 139., 140., 141., 142., 143., 144., 145., 146., 147., 148., 149., 150.],
         [151., 152., 153., 154., 155., 156., 157., 158., 159., 160., 161., 162., 163., 164., 165.],
         [166., 167., 168., 169., 170., 171., 172., 173., 174., 175., 176., 177., 178., 179., 180.],
         [181., 182., 183., 184., 185., 186., 187., 188., 189., 190., 191., 192., 193., 194., 195.],
         [196., 197., 198., 199., 200., 201., 202., 203., 204., 205., 206., 207., 208., 209., 210.],
         [211., 212., 213., 214., 215., 216., 217., 218., 219., 220., 221., 222., 223., 224., 225.],
         [226., 227., 228., 229., 230., 231., 232., 233., 234., 235., 236., 237., 238., 239., 240.]]])
-------------------------------------------------------------------------------
FLATTEN + TRANSPOSE:
240
torch.Size([2, 15, 8])
tensor([[[  1.,  16.,  31.,  46.,  61.,  76.,  91., 106.],
         [  2.,  17.,  32.,  47.,  62.,  77.,  92., 107.],
         [  3.,  18.,  33.,  48.,  63.,  78.,  93., 108.],
         [  4.,  19.,  34.,  49.,  64.,  79.,  94., 109.],
         [  5.,  20.,  35.,  50.,  65.,  80.,  95., 110.],
         [  6.,  21.,  36.,  51.,  66.,  81.,  96., 111.],
         [  7.,  22.,  37.,  52.,  67.,  82.,  97., 112.],
         [  8.,  23.,  38.,  53.,  68.,  83.,  98., 113.],
         [  9.,  24.,  39.,  54.,  69.,  84.,  99., 114.],
         [ 10.,  25.,  40.,  55.,  70.,  85., 100., 115.],
         [ 11.,  26.,  41.,  56.,  71.,  86., 101., 116.],
         [ 12.,  27.,  42.,  57.,  72.,  87., 102., 117.],
         [ 13.,  28.,  43.,  58.,  73.,  88., 103., 118.],
         [ 14.,  29.,  44.,  59.,  74.,  89., 104., 119.],
         [ 15.,  30.,  45.,  60.,  75.,  90., 105., 120.]],

        [[121., 136., 151., 166., 181., 196., 211., 226.],
         [122., 137., 152., 167., 182., 197., 212., 227.],
         [123., 138., 153., 168., 183., 198., 213., 228.],
         [124., 139., 154., 169., 184., 199., 214., 229.],
         [125., 140., 155., 170., 185., 200., 215., 230.],
         [126., 141., 156., 171., 186., 201., 216., 231.],
         [127., 142., 157., 172., 187., 202., 217., 232.],
         [128., 143., 158., 173., 188., 203., 218., 233.],
         [129., 144., 159., 174., 189., 204., 219., 234.],
         [130., 145., 160., 175., 190., 205., 220., 235.],
         [131., 146., 161., 176., 191., 206., 221., 236.],
         [132., 147., 162., 177., 192., 207., 222., 237.],
         [133., 148., 163., 178., 193., 208., 223., 238.],
         [134., 149., 164., 179., 194., 209., 224., 239.],
         [135., 150., 165., 180., 195., 210., 225., 240.]]])
-------------------------------------------------------------------------------
FLATTEN + TRANSPOSE + UNFLATTEN:
240
torch.Size([2, 15, 2, 1, 4])
tensor([[[[[  1.,  16.,  31.,  46.]],

          [[ 61.,  76.,  91., 106.]]],


         [[[  2.,  17.,  32.,  47.]],

          [[ 62.,  77.,  92., 107.]]],


         [[[  3.,  18.,  33.,  48.]],

          [[ 63.,  78.,  93., 108.]]],


         [[[  4.,  19.,  34.,  49.]],

          [[ 64.,  79.,  94., 109.]]],


         [[[  5.,  20.,  35.,  50.]],

          [[ 65.,  80.,  95., 110.]]],


         [[[  6.,  21.,  36.,  51.]],

          [[ 66.,  81.,  96., 111.]]],


         [[[  7.,  22.,  37.,  52.]],

          [[ 67.,  82.,  97., 112.]]],


         [[[  8.,  23.,  38.,  53.]],

          [[ 68.,  83.,  98., 113.]]],


         [[[  9.,  24.,  39.,  54.]],

          [[ 69.,  84.,  99., 114.]]],


         [[[ 10.,  25.,  40.,  55.]],

          [[ 70.,  85., 100., 115.]]],


         [[[ 11.,  26.,  41.,  56.]],

          [[ 71.,  86., 101., 116.]]],


         [[[ 12.,  27.,  42.,  57.]],

          [[ 72.,  87., 102., 117.]]],


         [[[ 13.,  28.,  43.,  58.]],

          [[ 73.,  88., 103., 118.]]],


         [[[ 14.,  29.,  44.,  59.]],

          [[ 74.,  89., 104., 119.]]],


         [[[ 15.,  30.,  45.,  60.]],

          [[ 75.,  90., 105., 120.]]]],



        [[[[121., 136., 151., 166.]],

          [[181., 196., 211., 226.]]],


         [[[122., 137., 152., 167.]],

          [[182., 197., 212., 227.]]],


         [[[123., 138., 153., 168.]],

          [[183., 198., 213., 228.]]],


         [[[124., 139., 154., 169.]],

          [[184., 199., 214., 229.]]],


         [[[125., 140., 155., 170.]],

          [[185., 200., 215., 230.]]],


         [[[126., 141., 156., 171.]],

          [[186., 201., 216., 231.]]],


         [[[127., 142., 157., 172.]],

          [[187., 202., 217., 232.]]],


         [[[128., 143., 158., 173.]],

          [[188., 203., 218., 233.]]],


         [[[129., 144., 159., 174.]],

          [[189., 204., 219., 234.]]],


         [[[130., 145., 160., 175.]],

          [[190., 205., 220., 235.]]],


         [[[131., 146., 161., 176.]],

          [[191., 206., 221., 236.]]],


         [[[132., 147., 162., 177.]],

          [[192., 207., 222., 237.]]],


         [[[133., 148., 163., 178.]],

          [[193., 208., 223., 238.]]],


         [[[134., 149., 164., 179.]],

          [[194., 209., 224., 239.]]],


         [[[135., 150., 165., 180.]],

          [[195., 210., 225., 240.]]]]])
-------------------------------------------------------------------------------
FLATTEN + TRANSPOSE + UNFLATTEN + FLATTEN:
240
torch.Size([2, 30, 1, 4])
tensor([[[[  1.,  16.,  31.,  46.]],

         [[ 61.,  76.,  91., 106.]],

         [[  2.,  17.,  32.,  47.]],

         [[ 62.,  77.,  92., 107.]],

         [[  3.,  18.,  33.,  48.]],

         [[ 63.,  78.,  93., 108.]],

         [[  4.,  19.,  34.,  49.]],

         [[ 64.,  79.,  94., 109.]],

         [[  5.,  20.,  35.,  50.]],

         [[ 65.,  80.,  95., 110.]],

         [[  6.,  21.,  36.,  51.]],

         [[ 66.,  81.,  96., 111.]],

         [[  7.,  22.,  37.,  52.]],

         [[ 67.,  82.,  97., 112.]],

         [[  8.,  23.,  38.,  53.]],

         [[ 68.,  83.,  98., 113.]],

         [[  9.,  24.,  39.,  54.]],

         [[ 69.,  84.,  99., 114.]],

         [[ 10.,  25.,  40.,  55.]],

         [[ 70.,  85., 100., 115.]],

         [[ 11.,  26.,  41.,  56.]],

         [[ 71.,  86., 101., 116.]],

         [[ 12.,  27.,  42.,  57.]],

         [[ 72.,  87., 102., 117.]],

         [[ 13.,  28.,  43.,  58.]],

         [[ 73.,  88., 103., 118.]],

         [[ 14.,  29.,  44.,  59.]],

         [[ 74.,  89., 104., 119.]],

         [[ 15.,  30.,  45.,  60.]],

         [[ 75.,  90., 105., 120.]]],


        [[[121., 136., 151., 166.]],

         [[181., 196., 211., 226.]],

         [[122., 137., 152., 167.]],

         [[182., 197., 212., 227.]],

         [[123., 138., 153., 168.]],

         [[183., 198., 213., 228.]],

         [[124., 139., 154., 169.]],

         [[184., 199., 214., 229.]],

         [[125., 140., 155., 170.]],

         [[185., 200., 215., 230.]],

         [[126., 141., 156., 171.]],

         [[186., 201., 216., 231.]],

         [[127., 142., 157., 172.]],

         [[187., 202., 217., 232.]],

         [[128., 143., 158., 173.]],

         [[188., 203., 218., 233.]],

         [[129., 144., 159., 174.]],

         [[189., 204., 219., 234.]],

         [[130., 145., 160., 175.]],

         [[190., 205., 220., 235.]],

         [[131., 146., 161., 176.]],

         [[191., 206., 221., 236.]],

         [[132., 147., 162., 177.]],

         [[192., 207., 222., 237.]],

         [[133., 148., 163., 178.]],

         [[193., 208., 223., 238.]],

         [[134., 149., 164., 179.]],

         [[194., 209., 224., 239.]],

         [[135., 150., 165., 180.]],

         [[195., 210., 225., 240.]]]])
-------------------------------------------------------------------------------
True
True
True
-------------------------------------------------------------------------------
